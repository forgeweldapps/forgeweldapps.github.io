<!DOCTYPE html>
<html>

<link rel="shortcut icon" type="image/png" href="https://sp.box.com/shared/static/fyibz7pa3nlorqtc8euvmm5uyo1aqw9e.png" />

<body>

    <h2 id="helpHeader">scan card:</h2>

    <form onsubmit="getURIandUpdatetext()" method="POST" return false>
        <input id="scanInput" type="text" name="scanInput" autofocus>
    </form>

    <p id="printed-uri-value"></p>

    <script>
        function getURIandUpdatetext() {
            var uriValue;
            var taskUri;
            var docuUri;
            var optaskUri;
            var projUri;
            var zendeskUri
            var trelloUri;
            var scanInput = document.getElementById("scanInput").value;
            window.name = "scannerWindow";

            if (scanInput != null || scanInput != "") {

                uriValue = scanInput;
                projUri = /^workfront...PROJ.ID./.test(uriValue);
                taskUri = /^workfront...TASK.ID./.test(uriValue);
                docuUri = /^workfront...DOCU.ID./.test(uriValue);
                optaskUri = /^workfront...OPTASK.ID./.test(uriValue);
                zendeskUri = /^zendesk...agent.tickets./.test(uriValue);
                trelloUri = /^trello...x.callback.url.showCard.shortlink./.test(uriValue);
            }

            /* example scan input: workfront://PROJ?ID=564f71b200d4b8f4a393335ed5a816c1   */

            if (projUri == true) {
                window.open(uriValue.replace(/^workfront...PROJ.ID./, "https://samaritan.my.workfront.com/project/view?ID="));

            }
            if (taskUri == true) {
                window.open(uriValue.replace(/^workfront...TASK.ID./, "https://samaritan.my.workfront.com/task/view?ID="));

            }
            if (docuUri == true) {
                window.open(uriValue.replace(/^workfront...DOCU.ID./, "https://samaritan.my.workfront.com/document/view?ID="));

            }
            if (optaskUri == true) {
                window.open(uriValue.replace(/^workfront...OPTASK.ID./, "https://samaritan.my.workfront.com/issue/view?ID="));

            }
            if (zendeskUri == true) {
                window.open(uriValue.replace(/^zendesk...agent.tickets./, "https://samaritanspurse.zendesk.com/agent/tickets/"));

            }
            if (trelloUri == true) {
                window.open(uriValue.replace(/^trello...x.callback.url.showCard.shortlink./, "https://trello.com/c/"));

            }

            window.focus("scannerWindow");
        }
    </script>

</body>

</html>
